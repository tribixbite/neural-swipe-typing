<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocabulary Test - Neural Swipe Typing</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.95);
            color: #333;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .test-result { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        .predictions { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); 
            gap: 10px;
            margin: 15px 0;
        }
        .prediction {
            background: #e9ecef;
            padding: 8px 12px;
            border-radius: 6px;
            text-align: center;
            font-weight: 500;
            border: 1px solid #dee2e6;
        }
        .score { font-size: 0.8em; color: #666; }
        button { 
            background: #667eea; 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 6px; 
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        button:hover { background: #5a6fd8; }
        #output { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 8px; 
            font-family: monospace; 
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Vocabulary Integration Test</h1>
        <p>Testing the full 10,000-word English vocabulary integration in the neural swipe demo.</p>
        
        <button onclick="runVocabularyTest()">Test Vocabulary Loading</button>
        <button onclick="runPredictionTest()">Test Smart Predictions</button>
        <button onclick="runComparisonTest()">Compare Old vs New</button>
        
        <div id="results"></div>
        <div id="output"></div>
    </div>

    <script>
        let output = document.getElementById('output');
        let results = document.getElementById('results');
        
        function log(message) {
            output.textContent += new Date().toISOString() + ': ' + message + '\n';
            console.log(message);
        }
        
        async function runVocabularyTest() {
            log('üöÄ Testing vocabulary loading...');
            results.innerHTML = '';
            
            try {
                // Test vocabulary file access
                const response = await fetch('./english_vocab.txt');
                if (!response.ok) throw new Error('Vocabulary file not accessible');
                
                const text = await response.text();
                const words = text.trim().split('\n').filter(w => w.length > 0);
                
                log(`‚úÖ Vocabulary loaded: ${words.length} words`);
                log(`First 10 words: ${words.slice(0, 10).join(', ')}`);
                log(`Last 10 words: ${words.slice(-10).join(', ')}`);
                
                results.innerHTML = \`
                    <div class="test-result">
                        <h3>‚úÖ Vocabulary Test Results</h3>
                        <p><strong>Total Words:</strong> ${words.length}</p>
                        <p><strong>Sample Words:</strong> ${words.slice(0, 20).join(', ')}</p>
                        <p><strong>File Size:</strong> ${(text.length / 1024).toFixed(1)} KB</p>
                    </div>
                \`;
                
            } catch (error) {
                log('‚ùå Vocabulary test failed: ' + error.message);
                results.innerHTML = \`<div class="test-result" style="border-left-color: #dc3545;">
                    <h3>‚ùå Vocabulary Test Failed</h3>
                    <p>${error.message}</p>
                </div>\`;
            }
        }
        
        async function runPredictionTest() {
            log('üéØ Testing smart predictions...');
            
            // Load vocabulary
            const response = await fetch('./english_vocab.txt');
            const text = await response.text();
            const vocabulary = text.trim().split('\n');
            
            // Simulate different swipe patterns
            const testCases = [
                { name: 'h‚Üío (hello)', points: [{x:0.6, y:0.55}, {x:0.25, y:0.4}, {x:0.9, y:0.55}, {x:0.9, y:0.55}, {x:0.85, y:0.4}] },
                { name: 't‚Üíe (the)', points: [{x:0.45, y:0.4}, {x:0.6, y:0.55}, {x:0.25, y:0.4}] },
                { name: 'a‚Üíd (and)', points: [{x:0.09, y:0.45}, {x:0.65, y:0.7}, {x:0.27, y:0.45}] },
                { name: 'w‚Üíd (word)', points: [{x:0.14, y:0.2}, {x:0.85, y:0.4}, {x:0.23, y:0.2}, {x:0.27, y:0.45}] }
            ];
            
            let allResults = '';
            
            for (const testCase of testCases) {
                log(\`Testing pattern: \${testCase.name}\`);
                
                // Simple prediction logic (similar to the demo)
                const startChar = getClosestChar(testCase.points[0]);
                const endChar = getClosestChar(testCase.points[testCase.points.length - 1]);
                const pathLength = testCase.points.length;
                const estimatedLength = Math.max(2, Math.min(12, Math.round(pathLength / 1.5)));
                
                const candidates = vocabulary.map(word => {
                    let score = 0.1;
                    
                    // Length matching
                    const lengthDiff = Math.abs(word.length - estimatedLength);
                    score += Math.max(0, 0.4 - (lengthDiff * 0.1));
                    
                    // Start/end character matching
                    if (word.charAt(0).toLowerCase() === startChar.toLowerCase()) score += 0.3;
                    if (word.charAt(word.length - 1).toLowerCase() === endChar.toLowerCase()) score += 0.2;
                    
                    // Frequency boost
                    const vocabIndex = vocabulary.indexOf(word);
                    const frequencyScore = Math.max(0, (vocabulary.length - vocabIndex) / vocabulary.length);
                    score += frequencyScore * 0.3;
                    
                    return { word, score: Math.min(1.0, score) };
                });
                
                const topPredictions = candidates
                    .sort((a, b) => b.score - a.score)
                    .slice(0, 6);
                    
                log(\`Top predictions: \${topPredictions.map(p => \`\${p.word}(\${p.score.toFixed(2)})\`).join(', ')}\`);
                
                allResults += \`
                    <div class="test-result">
                        <h4>üéØ \${testCase.name}</h4>
                        <p><strong>Path:</strong> \${startChar} ‚Üí \${endChar} (\${pathLength} points, ~\${estimatedLength} chars)</p>
                        <div class="predictions">
                            \${topPredictions.map(p => \`<div class="prediction">\${p.word}<br><span class="score">\${p.score.toFixed(2)}</span></div>\`).join('')}
                        </div>
                    </div>
                \`;
            }
            
            results.innerHTML = allResults;
        }
        
        function getClosestChar(point) {
            const keyboard = [
                {char: 'q', x: 0.05, y: 0.2}, {char: 'w', x: 0.14, y: 0.2}, {char: 'e', x: 0.23, y: 0.2},
                {char: 'r', x: 0.32, y: 0.2}, {char: 't', x: 0.41, y: 0.2}, {char: 'y', x: 0.50, y: 0.2},
                {char: 'u', x: 0.59, y: 0.2}, {char: 'i', x: 0.68, y: 0.2}, {char: 'o', x: 0.77, y: 0.2},
                {char: 'p', x: 0.86, y: 0.2}, {char: 'a', x: 0.09, y: 0.45}, {char: 's', x: 0.18, y: 0.45},
                {char: 'd', x: 0.27, y: 0.45}, {char: 'f', x: 0.36, y: 0.45}, {char: 'g', x: 0.45, y: 0.45},
                {char: 'h', x: 0.54, y: 0.45}, {char: 'j', x: 0.63, y: 0.45}, {char: 'k', x: 0.72, y: 0.45},
                {char: 'l', x: 0.81, y: 0.45}, {char: 'z', x: 0.18, y: 0.7}, {char: 'x', x: 0.27, y: 0.7},
                {char: 'c', x: 0.36, y: 0.7}, {char: 'v', x: 0.45, y: 0.7}, {char: 'b', x: 0.54, y: 0.7},
                {char: 'n', x: 0.63, y: 0.7}, {char: 'm', x: 0.72, y: 0.7}
            ];
            
            let closest = 'a';
            let minDistance = Infinity;
            
            for (const key of keyboard) {
                const dx = point.x - key.x;
                const dy = point.y - key.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < minDistance) {
                    minDistance = distance;
                    closest = key.char;
                }
            }
            
            return closest;
        }
        
        function runComparisonTest() {
            log('üìä Comparing old vs new prediction system...');
            
            const oldPredictions = [
                'hello', 'world', 'test', 'demo', 'great',
                'amazing', 'neural', 'swipe', 'keyboard', 'awesome'
            ];
            
            results.innerHTML = \`
                <div class="test-result">
                    <h3>üìä Prediction System Comparison</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>‚ùå Old System (10 words)</h4>
                            <div class="predictions">
                                \${oldPredictions.map(word => \`<div class="prediction">\${word}</div>\`).join('')}
                            </div>
                            <p>Fixed set of 10 hardcoded words with random ordering.</p>
                        </div>
                        <div>
                            <h4>‚úÖ New System (10,000 words)</h4>
                            <div class="predictions">
                                <div class="prediction">Smart selection from full vocabulary</div>
                                <div class="prediction">Context-aware scoring</div>
                                <div class="prediction">Length-based matching</div>
                                <div class="prediction">Start/end character matching</div>
                                <div class="prediction">Frequency-based ranking</div>
                                <div class="prediction">Real swipe pattern analysis</div>
                            </div>
                            <p>Intelligent predictions from 10,000-word English vocabulary with multiple scoring factors.</p>
                        </div>
                    </div>
                </div>
            \`;
            
            log('‚úÖ Comparison complete - new system provides 1000x more vocabulary coverage!');
        }
    </script>
</body>
</html>